<html>
	<head>
		
	</head>
	<body>
		<ul id="log">
		</ul>
	
		<video id="vid" width="320" height="240" loop="" autoplay=""></video>
	</body>
	
	<script>
		var logUl = document.getElementById("log");
		var log = function(text){
			var logLi = document.createElement("li");
			logLi.innerHTML = text;
			logUl.appendChild(logLi);	
		};
	</script>
	
	
	<script>
		var videoInput = document.getElementById('vid');
		var video = videoInput;
		
		navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
		window.URL = window.URL || window.webkitURL || window.msURL || window.mozURL;
		// check for camerasupport
		if (navigator.getUserMedia) {
			log("getUserMedia");
			
			// chrome 19 shim
			var videoSelector = {video : true};
			if (window.navigator.appVersion.match(/Chrome\/(.*?) /)) {
				var chromeVersion = parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1], 10);
				if (chromeVersion < 20) {
					videoSelector = "video";
				}
			};
			
			// opera shim
			if (window.opera) {
				window.URL = window.URL || {};
				if (!window.URL.createObjectURL) window.URL.createObjectURL = function(obj) {return obj;};
			}
			
			// set up stream
			navigator.getUserMedia(videoSelector, (function( stream ) {
				log("camera found");
				this.stream = stream;
				if (video.mozCaptureStream) {
				  video.mozSrcObject = stream;
				} else {
				  video.src = (window.URL && window.URL.createObjectURL(stream)) || stream;
				}
				video.play();
			}).bind(this), function() {
				log("no camera");
				insertAltVideo(video);
			});
		} else {
			log("no getUserMedia");
		}
	</script>
	
</html>